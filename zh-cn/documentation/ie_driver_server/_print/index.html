<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-cn class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://www.selenium.dev/zh-cn/documentation/ie_driver_server/><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>IE驱动服务器 | Selenium</title>
<meta name=description content="Internet Explorer驱动是一种实现WebDriver规范的单机服务器.
"><meta property="og:url" content="https://www.selenium.dev/zh-cn/documentation/ie_driver_server/"><meta property="og:site_name" content="Selenium"><meta property="og:title" content="IE驱动服务器"><meta property="og:description" content="Internet Explorer驱动是一种实现WebDriver规范的单机服务器."><meta property="og:locale" content="zh-cn"><meta property="og:type" content="website"><meta property="og:image" content="https://www.selenium.dev/images/selenium_4_logo.png"><meta itemprop=name content="IE驱动服务器"><meta itemprop=description content="Internet Explorer驱动是一种实现WebDriver规范的单机服务器.
"><meta itemprop=dateModified content="2022-01-23T23:14:22+05:30"><meta itemprop=wordCount content="370"><meta itemprop=image content="https://www.selenium.dev/images/selenium_4_logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.selenium.dev/images/selenium_4_logo.png"><meta name=twitter:title content="IE驱动服务器"><meta name=twitter:description content="Internet Explorer驱动是一种实现WebDriver规范的单机服务器.
"><link rel=preload href=/scss/main.min.259356d537fddc16a2ee106a30e8e5b6eb26cc50ed41865c32f1cbbfad79892a.css as=style><link href=/scss/main.min.259356d537fddc16a2ee106a30e8e5b6eb26cc50ed41865c32f1cbbfad79892a.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><link rel=stylesheet href=/css/prism.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3.6.0 integrity="sha512-AyDFDkYyALC5qoao077IqAOV7UC4oKCBTp+mJfjIt306AIRoBxoEZYDo0kAx/R7RbT+3EYEky1po/F1w1eQt7g==" crossorigin=anonymous><script defer data-domain=selenium.dev src=https://plausible.io/js/plausible.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand-lg navbar-light bg-white flex-row td-navbar"><a class=navbar-brand href=/zh-cn/><span class=navbar-logo><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 139.38 34"><defs><style>.cls-1{fill:#43b02a}</style></defs><title>Selenium logo green</title><path class="cls-1" d="M46.2 26.37a18.85 18.85.0 01-2.57-.2 25 25 0 01-2.74-.53v-1.39a25.31 25.31.0 002.71.53 18 18 0 002.5.2 5.51 5.51.0 003.29-.84 2.79 2.79.0 001.14-2.39 2.85 2.85.0 00-1.24-2.49A6 6 0 0048 18.55q-.78-.29-1.67-.55A15.93 15.93.0 0144 17.13a5.92 5.92.0 01-1.58-1.05 3.6 3.6.0 01-.9-1.34A5 5 0 0141.23 13a4.46 4.46.0 01.41-1.93 4.31 4.31.0 011.17-1.5 5.26 5.26.0 011.82-1A8 8 0 0147 8.28a20.51 20.51.0 014.41.57v1.42a20 20 0 00-2.23-.44 15.2 15.2.0 00-2-.15 4.86 4.86.0 00-3.08.9A2.9 2.9.0 0042.88 13a3.25 3.25.0 00.21 1.21 2.61 2.61.0 00.7 1 4.83 4.83.0 001.27.79 14.31 14.31.0 002 .68q1.11.33 2.06.71a6.21 6.21.0 011.65.94 4.09 4.09.0 011.1 1.38 4.54 4.54.0 01.4 2 4.15 4.15.0 01-1.56 3.48A7.16 7.16.0 0146.2 26.37z"/><path class="cls-1" d="M60.62 26.32a5.46 5.46.0 01-4.28-1.62A6.9 6.9.0 0154.88 20a7.8 7.8.0 011.43-5 5 5 0 014.14-1.75 4.24 4.24.0 013.47 1.43A6.48 6.48.0 0165.1 18.8q0 .54.0.92a3.22 3.22.0 01-.09.64H56.44a5.39 5.39.0 001.17 3.5A4.18 4.18.0 0060.8 25a10.52 10.52.0 001.82-.17 11.77 11.77.0 001.93-.52l.12 1.27a10.68 10.68.0 01-2 .55A11.47 11.47.0 0160.62 26.32zM60.4 14.43q-3.68.0-3.94 4.74h7.15a6.49 6.49.0 00-.78-3.63A2.76 2.76.0 0060.4 14.43z"/><path class="cls-1" d="M68.64 7h1.58V26.11H68.64z"/><path class="cls-1" d="M79.56 26.32a5.46 5.46.0 01-4.28-1.62A6.9 6.9.0 0173.83 20a7.8 7.8.0 011.43-5 5 5 0 014.14-1.75 4.24 4.24.0 013.47 1.43A6.48 6.48.0 0184 18.8q0 .54.0.92a3.22 3.22.0 01-.09.64H75.38a5.4 5.4.0 001.17 3.5A4.18 4.18.0 0079.75 25a10.52 10.52.0 001.82-.17 11.8 11.8.0 001.93-.52l.12 1.27a10.68 10.68.0 01-2 .55A11.47 11.47.0 0179.56 26.32zm-.21-11.89q-3.68.0-3.94 4.74h7.15a6.49 6.49.0 00-.78-3.63A2.76 2.76.0 0079.35 14.43z"/><path class="cls-1" d="M87.51 13.37h1.32l.12 1.49h.12q.94-.45 1.72-.78t1.43-.54a8.42 8.42.0 011.2-.31 6.54 6.54.0 011.1-.09A3.3 3.3.0 0197 14a3.63 3.63.0 01.83 2.63v9.51H96.24v-9a3 3 0 00-.55-2 2.18 2.18.0 00-1.69-.6 7.25 7.25.0 00-2.24.41 20.1 20.1.0 00-2.67 1.12v10H87.51z"/><path class="cls-1" d="M102.75 10.52a.93.93.0 01-1.06-1 1.06 1.06.0 012.12.0.93.93.0 01-1.06 1zm-.8 2.85h1.58V26.11h-1.58z"/><path class="cls-1" d="M110.81 26.34q-3.14.0-3.14-3.47v-9.5h1.58v9a3.16 3.16.0 00.48 2 1.92 1.92.0 001.59.6 6.83 6.83.0 002.48-.48q1.25-.48 2.59-1.14V13.37H118V26.11h-1.32l-.12-1.58h-.09l-1.73.81q-.74.34-1.38.57a7.9 7.9.0 01-1.23.33A7.34 7.34.0 01110.81 26.34z"/><path class="cls-1" d="M122.18 13.37h1.3l.14 1.49h.09a19.53 19.53.0 012.58-1.31 5.51 5.51.0 012-.41 2.83 2.83.0 013 1.77h.12q.8-.5 1.45-.83a12.61 12.61.0 011.2-.54 6.17 6.17.0 011-.31 5.18 5.18.0 011-.09 3.3 3.3.0 012.45.84 3.63 3.63.0 01.83 2.63v9.51h-1.56v-9a2.9 2.9.0 00-.55-2 2.21 2.21.0 00-1.69-.59 5.14 5.14.0 00-1.78.38A14.45 14.45.0 00131.6 16v10.1H130v-9a2.9 2.9.0 00-.55-2 2.21 2.21.0 00-1.69-.59 5.24 5.24.0 00-1.86.4A14 14 0 00123.76 16V26.11h-1.58z"/><path class="cls-1" d="M21.45 21.51a2.49 2.49.0 00-2.55 2.21.08.08.0 00.08.1h4.95a.08.08.0 00.08-.09 2.41 2.41.0 00-2.56-2.22z"/><path class="cls-1" d="M32.06 4.91 21.56 16.7a.32.32.0 01-.47.0l-5.36-5.53a.32.32.0 010-.4L17.5 8.5a.32.32.0 01.52.0l3 3.32a.32.32.0 00.49.0L29.87.36A.23.23.0 0029.69.0H.25A.25.25.0 000 .25v33.5A.25.25.0 00.25 34h32a.25.25.0 00.25-.25V5.06A.23.23.0 0032.06 4.91zm-23 25.36a8.08 8.08.0 01-5.74-2 .31.31.0 010-.41l1.25-1.75A.31.31.0 015 26a6.15 6.15.0 004.2 1.64c1.64.0 2.44-.76 2.44-1.56.0-2.48-8.08-.78-8.08-6.06.0-2.33 2-4.27 5.32-4.27a7.88 7.88.0 015.25 1.76.31.31.0 010 .43L12.9 19.65a.31.31.0 01-.45.05 6.08 6.08.0 00-3.84-1.32c-1.28.0-2 .57-2 1.41.0 2.23 8.06.74 8.06 6C14.67 28.33 12.84 30.27 9.05 30.27zM26.68 25.4a.27.27.0 01-.28.28H19a.09.09.0 00-.08.1 2.81 2.81.0 003 2.32 4.62 4.62.0 002.56-.84.27.27.0 01.4.06l.9 1.31a.28.28.0 01-.06.37 6.67 6.67.0 01-4.1 1.28 5.28 5.28.0 01-5.57-5.48 5.31 5.31.0 015.4-5.46c3.11.0 5.22 2.33 5.22 5.74z"/></svg></span>
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end" id=main_navbar><ul class="navbar-nav mr-4 mb-2 mb-lg-0 ps-4 ps-lg-2"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/zh-cn/about>About Selenium</a>
<a class=dropdown-item href=/zh-cn/project>Structure and Governance</a>
<a class=dropdown-item href=/zh-cn/events>Events</a>
<a class=dropdown-item href=/zh-cn/ecosystem>Ecosystem</a>
<a class=dropdown-item href=/zh-cn/history>History</a>
<a class=dropdown-item href=/zh-cn/getinvolved>Get Involved</a>
<a class=dropdown-item href=/zh-cn/sponsors>Sponsors</a>
<a class=dropdown-item href=/zh-cn/sponsor>Sponsor Us</a></div></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/zh-cn/downloads><span>Downloads</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/zh-cn/documentation><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/zh-cn/projects><span>Projects</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/zh-cn/support><span>Support</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/zh-cn/blog><span>Blog</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>中文简体</a><ul class=dropdown-menu><li><a class=dropdown-item href=/documentation/ie_driver_server/>English</a></li><li><a class=dropdown-item href=/pt-br/documentation/ie_driver_server/>Português (Brasileiro)</a></li><li><a class=dropdown-item href=/ja/documentation/ie_driver_server/>日本語</a></li></ul></div></li></ul><div class=navbar-nav><div class=td-search><div class=td-search--algolia id=docsearch-1></div></div></div></div></nav><section id=announcement-banner class="alert-static g-0 row -bg-selenium-blue"><div class="container g-0" style=padding:10px><div class="row g-0 justify-content-center"><div class="alert alert-selenium-blue col-12 fade show mb-0 p-0 -bg-selenium-blue" role=alert><h4 class="alert-heading text-center m-2">Selenium Conf 2025 Call for Proposals is now open! Submissions close 01 Dec, 2024.
<a href="https://seleniumconf.com/?utm_medium=Referral&utm_source=selenium.dev&utm_campaign=cfp" target=_blank aria-pressed=true>Learn more & submit!</a></h4></div></div></div></section></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>这是本节的多页打印视图。
<a href=# onclick="return print(),!1">点击此处打印</a>.</p><p><a href=/zh-cn/documentation/ie_driver_server/>返回本页常规视图</a>.</p></div><h1 class=title>IE驱动服务器</h1><div class=lead>Internet Explorer驱动是一种实现WebDriver规范的单机服务器.</div><ul><li>1: <a href=#pg-ba2a70d400adfd913cd1fc223657f3dd>Internet Explorer Driver Internals</a></li></ul><div class=content><p>This documentation previously located <a href=https://github.com/SeleniumHQ/selenium/wiki/InternetExplorerDriver-Internals>on the wiki</a></p><p><code>InternetExplorerDriver</code> 是一个独立的服务器,
它实现WebDriver的wire协议.
此驱动程序已在Windows 10的IE 11上进行了测试.
它可能适用于旧版本的IE和Windows,
但未受支持.</p><p>驱动程序支持运行32位和64位版本的浏览器.
启动浏览器的"位数",
取决于启动的IEDriverServer.exe的版本.
若是32位的<code>IEDriverServer.exe</code>已启动,
将启动32位版本的IE.
同样的, 如果启动的64位版本的IEDriverServer.exe,
将启动64位版本的IE.</p><h2 id=安装>安装</h2><p>尽管需要一些配置,
但是在使用<code>InternetExplorerDriver</code>之前,
您并不需要运行安装程序.
独立服务器可执行文件必须从<a href=https://www.selenium.dev/downloads/>下载</a>
页面下载并放置在您的<a href=http://en.wikipedia.org/wiki/PATH_(variable)>PATH</a> 中.</p><h2 id=pros>Pros</h2><ul><li>在真实浏览器中运行并支持JavaScript</li></ul><h2 id=cons>Cons</h2><ul><li>显然InternetExplorerDriver只能在Windows上运行!</li><li>相当慢 (尽管仍然很快 :)</li></ul><h2 id=命令行开关>命令行开关</h2><p>作为一个独立的可执行文件,
IE驱动程序的行为可以通过各种命令行参数进行修改.
要设置这些命令行参数的值,
应参考所使用语言绑定的文档.
下表描述了支持的命令行开关.
支持所有 -<code>&lt;开关></code>, &ndash;<code>&lt;开关></code>
和 /<code>&lt;开关></code> .</p><table><thead><tr><th style=text-align:left>开关</th><th style=text-align:left>释义</th></tr></thead><tbody><tr><td style=text-align:left>&ndash;port=<code>&lt;端口号></code></td><td style=text-align:left>指定IE驱动程序的HTTP服务器将在其上侦听来自语言绑定的命令的端口. 默认值为5555.</td></tr><tr><td style=text-align:left>&ndash;host=<code>&lt;主机IP地址></code></td><td style=text-align:left>指定主机适配器的IP地址, IE驱动程序的HTTP服务器将在其上侦听来自语言绑定的命令. 默认值为127.0.0.1.</td></tr><tr><td style=text-align:left>&ndash;log-level=<code>&lt;日志级别></code></td><td style=text-align:left>指定日志消息的输出级别. 有效值包括 FATAL, ERROR, WARN, INFO, DEBUG, 以及 TRACE. 默认为FATAL.</td></tr><tr><td style=text-align:left>&ndash;log-file=<code>&lt;日志文件></code></td><td style=text-align:left>指定日志文件的完整路径和文件名. 默认为标准输出.</td></tr><tr><td style=text-align:left>&ndash;extract-path=<code>&lt;路径></code></td><td style=text-align:left>指定用于提取服务器使用的支持文件的目录的完整路径. 如果未指定, 则默认为临时目录.</td></tr><tr><td style=text-align:left>&ndash;silent</td><td style=text-align:left>在服务器启动时抑制诊断输出.</td></tr></tbody></table><h2 id=重要的系统属性>重要的系统属性</h2><p>以下系统属性用于 <code>InternetExplorerDriver</code>
(在Java代码中使用 <code>System.getProperty()</code>
读取并使用<code>System.setProperty()</code> 进行设置, 或者
在命令行标识 &ldquo;<code>-DpropertyName=value</code>&rdquo;) :</p><table><thead><tr><th style=text-align:left><strong>属性</strong></th><th style=text-align:left><strong>含义</strong></th></tr></thead><tbody><tr><td style=text-align:left><code>webdriver.ie.driver</code></td><td style=text-align:left>IE驱动程序二进制文件的位置.</td></tr><tr><td style=text-align:left><code>webdriver.ie.driver.host</code></td><td style=text-align:left>指定IE驱动程序将在其上侦听的主机适配器的IP地址.</td></tr><tr><td style=text-align:left><code>webdriver.ie.driver.loglevel</code></td><td style=text-align:left>指定日志消息的输出级别. 有效值包括 FATAL, ERROR, WARN, INFO, DEBUG, 以及 TRACE. 默认为FATAL.</td></tr><tr><td style=text-align:left><code>webdriver.ie.driver.logfile</code></td><td style=text-align:left>指定日志文件的完整路径和文件名.</td></tr><tr><td style=text-align:left><code>webdriver.ie.driver.silent</code></td><td style=text-align:left>在IE驱动程序启动时抑制诊断输出.</td></tr><tr><td style=text-align:left><code>webdriver.ie.driver.extractpath</code></td><td style=text-align:left>指定用于提取服务器使用的支持文件的目录的完整路径. 如果未指定, 则默认为临时目录.</td></tr></tbody></table><h2 id=必要的配置>必要的配置</h2><ul><li><code>IEDriverServer</code>可执行文件必须<a href=https://www.selenium.dev/downloads/>已下载</a> 并放置在您的 <a href=http://en.wikipedia.org/wiki/PATH_(variable)>PATH</a> 中.</li><li>在Windows Vista, Windows 7或Windows 10上的IE 7或更高版本上, 必须将每个区域的保护模式设置设置为相同的值. 该值可以打开或关闭, 只要每个区域的值相同. 要设置受保护模式设置, 请从“工具”菜单中选择“Internet选项…”, 然后单击“安全”选项卡. 对于每个区域, 标签底部将有一个复选框, 标记为“启用保护模式”.</li><li>此外, IE 10及更高版本必须禁用“增强保护模式”. 此选项位于“Internet选项”对话框的“高级”选项卡中.</li><li>浏览器缩放级别必须设置为100%, 以便将本机鼠标事件设置为正确的坐标.</li><li>对于Windows 10, 您还需要在显示设置中将“更改文本、应用程序和其他项目的大小”设置为100%.</li><li><em>仅</em> 对于IE 11, 您需要在目标计算机上设置一个注册表项, 以便驱动程序能够保持与它创建的Internet Explorer实例的连接. 对于32位Windows安装, 您必须在注册表编辑器中检查的项是<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BFCACHE</code>. 对于64位Windows安装, 键为 <code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BFCACHE</code>. 请注意, <code>FEATURE_BFCACHE</code> 子项可能存在, 也可能不存在, 如果不存在, 则应创建该子项. <strong>要点:</strong> 在此键内, 创建一个名为<code>iexplore.exe</code>值为0的DWORD.</li></ul><h2 id=原生事件以及internet-explorer>原生事件以及Internet Explorer</h2><p>由于 <code>InternetExplorerDriver</code> 仅适用于Windows,
因此它尝试使用所谓的“原生”或操作系统级事件
在浏览器中执行鼠标和键盘操作.
针对同样的操作,
与使用JavaScript模拟相比有明显的差异.
使用原生事件的优点是它不依赖于JavaScript沙箱,
并且可以确保在浏览器中正确传播JavaScript事件.
但是, 当IE浏览器窗口失焦,
以及当尝试将鼠标悬停在元素上时,
当前存在一些鼠标事件问题.</p><h3 id=浏览器焦点>浏览器焦点</h3><p>难点在于, 如果窗口没有焦点,
IE本身似乎没有完全尊重我们在IE浏览器窗口
(<code>WM\_MOUSEDOWN</code> 和 <code>WM\_MOUSEUP</code>) 上发送的Windows消息.
具体来说, 被单击的元素将在其周围接收一个焦点窗口,
但该元素不会处理该单击.
可以说, 我们根本不应该发送信息；
相反, 我们应该使用 <code>SendInput()</code> API,
但该API明确要求窗口具有焦点.
WebDriver项目有两个相互冲突的目标.</p><p>首先, 我们争取尽可能地模仿用户.
这意味着使用原生事件,
而不是使用JavaScript模拟事件.</p><p>其次, 我们不希望浏览器窗口的焦点被自动化.
这意味着仅将浏览器窗口强制到前台是次优的. .</p><p>另一个考虑因素是
多个IE实例在多个WebDriver实例下运行的可能性,
这意味着任何此类“将窗口置于前台”解决方案
都必须包装某种同步结构 (互斥体?)到
IE驱动程序的C++代码中.
即使如此, 若用户将另一个窗口带到前台的操作,
介于驱动程序将IE带到前台和执行原生事件之间,
则此代码仍将受制于竞争条件.</p><p>围绕驱动程序的需求,
以及如何对这两个相互冲突的目标进行优先排序的讨论正在进行中.
当前流行的观点是前者优先于后者,
并在使用IE驱动程序时,
将您的机器标记为无法执行其他任务.
然而, 这一决定远未最终确定,
实现这一决定的代码可能相当复杂.</p><h3 id=悬停在元素上>悬停在元素上</h3><p>当您尝试将鼠标悬停在元素上,
并且物理鼠标光标位于IE浏览器窗口的边界内时,
鼠标悬停将不起作用.
更具体地说, 悬停将在几分之一秒内工作,
然后元素将恢复到其以前的状态.
出现这种情况的普遍理论是,
IE在其事件循环期间正在进行某种类型的命中测试,
这导致它在物理光标位于窗口边界内时响应物理鼠标位置.
WebDriver开发团队仍未找到解决IE这种行为的方法.</p><h3 id=点击元素选项或提交表单以及弹窗>点击元素<code>选项</code>或提交表单以及<code>弹窗</code></h3><p>IE驱动程序在两个地方不使用原生事件与元素交互.
这是在 <code>&lt;select></code> 元素中单击 <code>&lt;option></code> 元素.
在正常情况下, IE驱动程序根据元素的位置和大小计算单击位置,
通常由JavaScript <code>getBoundingClientRect()</code> 方法返回.
但是, 对于 <code>&lt;option></code> 元素,
<code>getBoundingClientRect()</code> 返回一个位置为零、大小为零的矩形.
IE驱动程序通过使用 <code>click()</code> 来处理这一场景,
它本质上设置了元素 <code>.selected</code> 的属性,
并在JavaScript中模拟 <code>onChange</code> 事件.
但是, 这意味着如果 <code>&lt;select></code> 元素的 <code>onChange</code> 事件
包含调用 <code>alert()</code>, <code>confirm()</code> 或 <code>prompt()</code>的JavaScript代码,
则调用WebElement的 <code>click()</code> 方法将挂起,
直到手动取消模式对话框.
对于此行为, 仅使用WebDriver代码没有已知的解决方法.</p><p>类似地, 在某些情况下,
通过WebElement的<code>submit()</code>方法提交HTML表单
可能会产生相同的效果.
如果驱动程序调用表单上的JavaScript<code>submit()</code>函数,
并且有一个onSubmit事件处理程序调用
JavaScript <code>alert()</code>, <code>confirm()</code> 或 <code>prompt()</code>函数,
则可能发生这种情况.</p><p>该限制被记录为3508号问题 (谷歌代码).</p><h2 id=internetexplorerdriver多实例><code>InternetExplorerDriver</code>多实例</h2><p>随着 <code>IEDriverServer.exe</code>的创建,
应该可以同时创建和使用<code>InternetExplorerDriver</code>的多个实例.
但是, 此功能基本上未经测试,
并且可能存在cookie、窗口焦点等问题.
如果尝试使用IE驱动程序的多个实例,
并遇到这些问题,
请考虑使用<code>RemoteWebDriver</code> 和虚拟机.</p><p>对于InternetExplorer的多个实例之间
共享的Cookie (和其他会话项) 问题,
有两种解决方案.</p><p>首先是在私有模式下启动InternetExplorer.
在此之后, InternetExplorer将使用干净的会话数据启动,
并且在退出时不会保存更改的会话数据.
为此, 您需要向驱动程序传递2个特定功能：
具有 <code>true</code> 值的 <code>ie.forceCreateProcessApi</code> 和具有 <code>-private</code> 值的 <code>ie.browserCommandLineSwitches</code> .
请注意, 它仅适用于InternetExplorer 8及更高版本,
Windows注册表<code>HKLM_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main</code>
路径应包含值为 <code>0</code> 的<code>TabProcGrowth</code> 键.</p><p>第二个是在InternetExplorer启动期间清理会话.
为此, 您需要将具有 <code>true</code> 值的
特定 <code>ie.ensureCleanSession</code> 功能传递给驱动程序.
这将清除InternetExplorer所有运行实例的缓存,
包括手动启动的实例.</p><h2 id=远程远行-iedriverserverexe>远程远行 <code>IEDriverServer.exe</code></h2><p>由 <code>IEDriverServer.exe</code> 启动的HTTP服务器,
将访问控制列表设置为仅接受来自本地计算机的连接,
并禁止来自远程计算机的传入连接.
目前, 如果不修改<code>IEDriverServer.exe</code>的源代码,
这一点是无法更改的.
要在远程计算机上运行Internet Explorer驱动程序,
请将Java独立远程服务器
与语言绑定的等效<code>RemoteWebDriver</code>结合使用.</p><h2 id=按照windows服务运行-iedriverserverexe>按照Windows服务运行 <code>IEDriverServer.exe</code></h2><p>明确不支持尝试使用IEDriverServer.exe
作为Windows服务应用程序的一部分.
服务进程及其衍生的流程的需求
与在常规用户上下文中执行的流程有很大不同.
<code>IEDriverServer.exe</code> 在该环境中未经测试,
并且包括明确地禁止在服务进程中使用的Windows API调用.
虽然可以让IE驱动程序在服务进程下运行,
但在该环境中遇到问题的用户需要寻求自己的解决方案.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-ba2a70d400adfd913cd1fc223657f3dd>1 - Internet Explorer Driver Internals</h1><div class=lead>More detailed information on the IE Driver.</div><h2 id=client-code-into-the-driver>Client Code Into the Driver</h2><p>We use the W3C WebDriver protocol to communicate with a local instance of an HTTP server. This greatly simplifies the implementation of the language-specific code, and minimzes the number of entry points into the C++ DLL that must be called using a native-code interop technology such as <a href=https://jna.dev.java.net/>JNA</a>, <a href=http://docs.python.org/library/ctypes.html>ctypes</a>, <a href=http://msdn.microsoft.com/en-us/library/aa446536.aspx>pinvoke</a> or <a href=http://www.ruby-doc.org/stdlib/libdoc/dl/rdoc/index.html>DL</a>.</p><h3 id=memory-management>Memory Management</h3><p>The IE driver utilizes the Active Template Library (ATL) to take advantage of its implementation of smart pointers to COM objects. This makes reference counting and cleanup of COM objects much easier.</p><h2 id=why-do-we-require-protected-mode-settings-changes>Why Do We Require Protected Mode Settings Changes?</h2><p>IE 7 on Windows Vista introduced the concept of Protected Mode, which allows for some measure of protection to the underlying Windows OS when browsing. The problem is that when you manipulate an instance of IE via COM, and you navigate to a page that would cause a transition into or out of Protected Mode, IE requires that another browser session be created. This will orphan the COM object of the previous session, not allowing you to control it any longer.</p><p>In IE 7, this will usually manifest itself as a new top-level browser window; in IE 8, a new IExplore.exe process will be created, but it will usually (not always!) seamlessly attach it to the existing IE top-level frame window. Any browser automation framework that drives IE externally (as opposed to using a WebBrowser control) will run into these problems.</p><p>In order to work around that problem, we dictate that to work with IE, all zones must have the same Protected Mode setting. As long as it&rsquo;s on for all zones, or off for all zones, we can prevent the transistions to different Protected Mode zones that would invalidate our browser object. It also allows users to continue to run with UAC turned on, and to run securely in the browser if they set Protected Mode &ldquo;on&rdquo; for all zones.</p><p>In earlier releases of the IE driver, if the user&rsquo;s Protected Mode settings were not correctly set, we would launch IE, and the process would simply hang until the HTTP request timed out. This was suboptimal, as it gave no indication what needed to be set. Erring on the side of caution, we do not modify the user&rsquo;s Protected Mode settings. Current versions, however check that the Protected Mode settings are properly set, and will return an error response if they are not.</p><h2 id=keyboard-and-mouse-input>Keyboard and Mouse Input</h2><p>Key files: <a href=https://github.com/SeleniumHQ/selenium/blob/master/cpp/webdriver-interactions/interactions.cpp>interactions.cpp</a></p><p>There are two ways that we could simulate keyboard and mouse input. The first way, which is used in parts of webdriver, is to synthesize events on the DOM. This has a number of drawbacks, since each browser (and version of a browser) has its own unique quirks; to model each of these is a demanding task, and impossible to get completely right (for example, it&rsquo;s hard to tell what <code>window.selection</code> should be and this is a read-only property on some browsers) The alternative approach is to synthesize keyboard and mouse input at the OS level, ideally without stealing focus from the user (who tends to be doing other things on their computer as long-running webdriver tests run)</p><p>The code for doing this is in <a href=https://github.com/SeleniumHQ/selenium/blob/master/cpp/webdriver-interactions/interactions.cpp>interactions.cpp</a> The key thing to note here is that we use PostMessages to push window events on to the message queue of the IE instance. Typing, in particular, is interesting: we only send the &ldquo;keydown&rdquo; and &ldquo;keyup&rdquo; messages. The &ldquo;keypress&rdquo; event is created if necessary by IE&rsquo;s internal event processing. Because the key press event is not always generated (for example, not every character is printable, and if the default event bubbling is cancelled, listeners don&rsquo;t see the key press event) we send a &ldquo;probe&rdquo; event in after the key down. Once we see that this has been processed, we know that the key press event is on the stack of events to be processed, and that it is safe to send the key up event. If this was not done, it is possible for events to fire in the wrong order, which is definitely sub-optimal.</p><h1 id=working-on-the-internetexplorerdriver>Working On the InternetExplorerDriver</h1><p>Currently, there are tests that will run for the InternetExplorerDriver in all languages (Java, C#, Python, and Ruby), so you should be able to test your changes to the native code no matter what language you&rsquo;re comfortable working in from the client side. For working on the C++ code, you&rsquo;ll need Visual Studio 2010 Professional or higher. Unfortunately, the C++ code of the driver uses ATL to ease the pain of working with COM objects, and ATL is not supplied with Visual C++ 2010 Express Edition. If you&rsquo;re using Eclipse, the process for making and testing modifications is:</p><ol><li>Edit the C++ code in VS.</li><li>Build the code to ensure that it compiles</li><li>Do a complete rebuild when you are ready to run a test. This will cause the created DLL to be copied to the right place to allow its use in Eclipse</li><li>Load Eclipse (or some other IDE, such as Idea)</li><li>Edit the <code>SingleTestSuite</code> so that it is <code>usingDriver(IE)</code></li><li>Create a JUnit run configuration that uses the &ldquo;webdriver-internet-explorer&rdquo; project. If you don&rsquo;t do this, the test won&rsquo;t work at all, and there will be a somewhat cryptic error message on the console.</li></ol><p>Once the basic setup is done, you can start working on the code pretty quickly. You can attach to the process you execute your code from using Visual Studio (from the Debug menu, select Attach to Process&mldr;).</p></div></main></div></div><div class="row justify-content-center p-5"><h2 class="selenium text-center">Development Partners</h2></div><div class="row justify-content-around pt-4 pb-5 px-5"><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href="https://www.browserstack.com/automate?utm_campaign=open-source-sponsor&amp;utm_campaigncode=701OW000009sQwVYAU&amp;utm_medium=partnered&amp;utm_source=seleniumorg" class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/browserstack.png alt=BrowserStack></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href="https://saucelabs.com/resources/topic-hub/selenium?utm_source=selenium&amp;utm_medium=website&amp;utm_campaign=selenium-sponsorship-fy25" class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/saucelabs.png alt="Sauce Labs"></a></div></div><div class="row justify-content-center p-5"><h2 class="selenium text-center">Selenium Level Sponsors</h2></div><div class="row justify-content-around pt-4 pb-5 px-5"><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href="https://brightdata.com/?utm_source=brand&amp;utm_campaign=brnd-mkt_partners_selenium" class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/bright-data.png alt="Bright Data"></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href=https://applitools.com/ class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/applitools.png alt=Applitools></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href="https://www.lambdatest.com/selenium-automation?utm_source=selenium&amp;utm_medium=open-source-sponsor&amp;utm_campaign=nov_14&amp;utm_term=sk&amp;utm_content=web" class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/lambda-test.png alt=LambdaTest></a></div></div><div class="row justify-content-center pt-2 pb-3 -bg-selenium-cyan"><div class="card text-center border-0 bg-transparent py-5"><div class="card-body text-white"><h2 class=card-title>Support the Selenium Project</h2><p class=card-text>Learn more or view the full list of sponsors.</p><div class=selenium-button-container><a href=/sponsors class="selenium-button selenium-white-cyan text-uppercase fw-bold">Learn more
<i class="ps-3 fas fa-caret-right"></i></a></div></div></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/group/selenium-users aria-label="User mailing list"><i class="fas fa-mail-bulk"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="Selenium in Twitter" aria-label="Selenium in Twitter"><a class=text-white target=_blank rel=noopener href=https://twitter.com/SeleniumHQ aria-label="Selenium in Twitter"><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="SeleniumConf YouTube Channel" aria-label="SeleniumConf YouTube Channel"><a class=text-white target=_blank rel=noopener href=https://www.youtube.com/channel/UCbDlgX_613xNMrDqCe3QNEw aria-label="SeleniumConf YouTube Channel"><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-4 text-end text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="Software Freedom Conservancy" aria-label="Software Freedom Conservancy"><a class=text-white target=_blank rel=noopener href=mailto:selenium@sfconservancy.org aria-label="Software Freedom Conservancy"><i class="fas fa-envelope-square"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/seleniumhq/selenium aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://join.slack.com/t/seleniumhq/shared_invite/zt-2o0ilal4i-WzCcTdrlpmmsuE2TDILmgg aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title=IRC aria-label=IRC><a class=text-white target=_blank rel=noopener href=https://kiwiirc.com/nextclient/irc.libera.chat/#selenium aria-label=IRC><i class="fas fa-comments"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="Developer mailing list" aria-label="Developer mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/g/selenium-developers aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul><a href=https://www.netlify.com><img style=margin-right:50px src=https://www.netlify.com/v3/img/components/netlify-light.svg alt="Deploys by Netlify"></a></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2024 Software Freedom Conservancy 保留所有权利</small><p class=mt-2><a href=/zh-cn/documentation/about/>关于这个文档</a></p></div></div></div></footer></div><script src=/js/main.min.0a56205ed1c75268f017591e5418fdb944578a279fe7c7abe3981ebed191c341.js integrity="sha256-ClYgXtHHUmjwF1keVBj9uURXiief58er45gevtGRw0E=" crossorigin=anonymous></script><script src=/js/prism.js></script><script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3.6.0 integrity="sha512-FtDaTWf3IS29TLuYzTPlytjGqcXkwrzG9ivq7xXElnOZeiYTbcIy/hwXAgrrRNnI0+PfN+WFz4/+4phhJmuS8Q==" crossorigin=anonymous></script><script type=text/javascript>const containers=["#docsearch-0","#docsearch-1"];for(let e of containers)docsearch({container:e,appId:"6IOXA5JK7Z",apiKey:"2b44a1d3530f9951dd6502059058984a",indexName:"selenium"})</script><script src=/js/tabpane-persist.js></script></body></html>